<!--
/*******************************************************************************
#      ____               __          __  _      _____ _       _               #
#     / __ \              \ \        / / | |    / ____| |     | |              #
#    | |  | |_ __   ___ _ __ \  /\  / /__| |__ | |  __| | ___ | |__   ___      #
#    | |  | | '_ \ / _ \ '_ \ \/  \/ / _ \ '_ \| | |_ | |/ _ \| '_ \ / _ \     #
#    | |__| | |_) |  __/ | | \  /\  /  __/ |_) | |__| | | (_) | |_) |  __/     #
#     \____/| .__/ \___|_| |_|\/  \/ \___|_.__/ \_____|_|\___/|_.__/ \___|     #
#           | |                                                                #
#           |_|                 _____ _____  _  __                             #
#                              / ____|  __ \| |/ /                             #
#                             | (___ | |  | | ' /                              #
#                              \___ \| |  | |  <                               #
#                              ____) | |__| | . \                              #
#                             |_____/|_____/|_|\_\                             #
#                                                                              #
#                              (c) 2011-2012 by                                #
#           University of Applied Sciences Northwestern Switzerland            #
#                     Institute of Geomatics Engineering                       #
#                          Author:robert.wst@gmail.com                         #
********************************************************************************
*     Licensed under MIT License. Read the file LICENSE for more information   *
*******************************************************************************/
                      GeoGame: Prototype
*******************************************************************************/-->
<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="../../WebViewer/compiled/owg-optimized.js"></script>
    <script type="text/javascript" src="kineticjs.js"></script>
    <script type="text/javascript" src="fx.js"></script>
    <script type="text/javascript" src="ui.js"></script>
    <link href="style.css" rel="stylesheet" type="text/css" />
</head>
<body style="overflow:hidden;" onload="Init()">
<div id="main_div" class="main_div">
    <!--<canvas  id="canvas2d" class="canvas2d">
    </canvas>-->
</div>
<div id="owg_div" class="owg_div">
    <canvas id="canvas" class="canvas">

    </canvas>
</div>

<script type="text/javascript">
    ogSetArtworkDirectory("../../../art/");

    /* Members */
    var m_images = {};
    var m_loadedImages = 0;
    var m_numImages = 0;
    var m_context = ogCreateContextFromCanvas("canvas", true);
    var m_globe = ogCreateGlobe(m_context);
    var m_stage = new Kinetic.Stage("main_div", window.innerWidth, window.innerHeight);
    var m_ui = new Kinetic.Layer();
    var m_static = new Kinetic.Layer();

    /* Garbage Collection */
    function TerminateShape(shape, layer)
    {
        layer.remove(shape);
    }


    /* Preload functions */
    function LoadImages(sources){
        // get num of sources
        for (var src in sources) {
            m_numImages++;
        }
        for (var src in sources) {
            m_images[src] = new Image();
            /*m_images[src].onload = function(){
                if (++m_loadedImages >= m_numImages) {
                    callback(images);
                }
            };*/
            m_images[src].src = sources[src];
        }
    }

    /* Preload data */
    function Init() {
        // Preload images
        var sources = {
            btn_01: "../art/btn_01.png",
            btn_01_c: "../art/btn_01_c.png",
            btn_01_h: "../art/btn_01_h.png",
            clock: "../art/clock.png",
            dial: "../art/dial.png"
        };
        LoadImages(sources);

        // Add OWG Data
      /*  ogAddImageLayer(m_globe, {
            url: ["http://www.openwebglobe.org/data/img"],
            layer: "World500",
            service: "i3d"
        });
        ogAddImageLayer(m_globe, {
            url: ["http://www.openwebglobe.org/data/img"],
            layer: "LandsatCH",
            service: "i3d"
        });
        ogAddElevationLayer(m_globe, {
            url: ["http://www.openwebglobe.org/data/elv"],
            layer: "SRTM",
            service: "i3d"
        });*/
        ogSetRenderFunction(m_context, OnRender);
        ogSetResizeFunction(m_context, OnResize);

        myClock = new Clock(m_ui, 50, 50, 60);

        myButton = new Button01(m_ui, 500, 300, 300, 69, "Start", 15);
        myButton1 = new Button01(m_ui, 500, 380, 300, 69, "Reset", 15);
        myButton2 = new Button01(m_ui, 500, 460, 300, 69, "Testdialog", 15);
        myButton.onClickEvent = MyButtonClick;
        myButton1.onClickEvent = MyButton1Click;
        myButton2.onClickEvent = MyButton2Click;

        m_stage.add(m_static);
        m_stage.add(m_ui);
        m_stage.onFrame(function(frame){
            OnCanvasRender(frame);
        });
        m_stage.start();
    }






    /* Render Callback */
    function OnCanvasRender(frame)
    {
        m_stage.draw();
    }

    function OnRender(context)
    {

    }

    function OnResize(context)
    {
        m_stage.setSize(window.innerWidth, window.innerHeight);
    }

    /* event callbacks */
    function MyButtonClick()
    {
        //myText = new FlyingText(m_static, "+120 Punkte", "#00DD00");
        myClock.countdown();
    }
    function MyButton1Click()
    {
        myClock.reset(60);
    }

    function MyButton2Click()
    {
        var myDialog = new MessageDialog(m_ui, "This is a test message", 550, 250);
    }

    
</script>
</body>
</html>
